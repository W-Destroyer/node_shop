{"version":3,"sources":["public/src/js/index.js"],"names":["define","initNav","Swiper","pagination","classifyTpl","productTpl","initBanner","initProduct","initClassNav","$","get","done","res","code","tpl","id","name","data","map","append","item","_id","initProductList","productType","num","length","isNotPage","type","startPos","path","empty","productList","totalPage","Math","floor","totalCount","container","totalPages","onPageChange","number","mySwiper","autoplay","loop","nextButton","prevButton","paginationClickable","autoplayDisableOnInteraction","swiperWidth","document","body","clientWidth","_","isObject","JSON","parse","classifyHtml","template","classItem","productHtml","productItem","showCount","option","slidesPerView","slidesPerGroup","classId"],"mappings":";;AAAAA,OAAO,CACH,mBADG,EACkB,QADlB,EAC4B,mBAD5B,EACiD,uBADjD,EAC0E,sBAD1E,EACkG,WADlG,CAAP,EAEG,UAASC,OAAT,EAAkBC,MAAlB,EAA0BC,UAA1B,EAAsCC,WAAtC,EAAmDC,UAAnD,EAA+D;AAC9D,KAAC,YAAU;AACPJ;AACAK;AACAC;AACH,KAJD;;AAMA,aAASC,YAAT,GAAwB;AACpBC,UAAEC,GAAF,CAAM,8BAAN,EAAsCC,IAAtC,CAA2C,UAASC,GAAT,EAAc;AACrD,gBAAIA,IAAIC,IAAJ,IAAY,CAAhB,EACI;AACJ,gBAAIC,MAAM,SAANA,GAAM,GAA6B;AAAA,oBAApBC,EAAoB,uEAAf,EAAe;AAAA,oBAAXC,IAAW,uEAAJ,EAAI;;AACnC,wGACkBD,EADlB,8DAEgBC,IAFhB;AAKH,aAND;AAOAJ,gBAAIK,IAAJ,CAASC,GAAT,CAAa,gBAAQ;AACjBT,kBAAE,iBAAF,EAAqBU,MAArB,CAA4BL,IAAIM,KAAKC,GAAT,EAAcD,KAAKJ,IAAnB,CAA5B;AACH,aAFD;AAGAM,4BAAgBV,IAAIK,IAAJ,CAAS,CAAT,EAAYF,EAA5B;AACH,SAdD;AAeH;;AAED,aAASO,eAAT,CAAyBC,WAAzB,EAAsCC,GAAtC,EAA2CC,MAA3C,EAAmDC,SAAnD,EAA8D;AAC1DF,cAAMA,OAAO,CAAb;AACAC,iBAASA,UAAU,CAAnB;AACAhB,UAAEC,GAAF,CAAM,mCAAN,EAA2C;AACvCiB,kBAAMJ,WADiC;AAEvCK,sBAAUJ,MAAMC,MAFuB;AAGvCA,oBAAQA;AAH+B,SAA3C,EAIGd,IAJH,CAIQ,UAASC,GAAT,EAAc;AAClB,gBAAIA,IAAIC,IAAJ,IAAY,CAAhB,EACI;AACJ,gBAAIC,MAAM,SAANA,GAAM,GAA+B;AAAA,oBAAtBe,IAAsB,uEAAf,EAAe;AAAA,oBAAXb,IAAW,uEAAJ,EAAI;;AACrC,yKAEgCa,IAFhC,eAE8Cb,IAF9C,gIAI8DA,IAJ9D;AAMH,aAPD;AAQAP,cAAE,gBAAF,EAAoBqB,KAApB;AACAlB,gBAAIK,IAAJ,CAASc,WAAT,CAAqBb,GAArB,CAAyB,gBAAQ;AAC7BT,kBAAE,gBAAF,EAAoBU,MAApB,CAA2BL,IAAIM,KAAKS,IAAT,EAAeT,KAAKJ,IAApB,CAA3B;AACH,aAFD;;AAIA,gBAAIU,SAAJ,EACI;AACJ,gBAAIM,YAAYC,KAAKC,KAAL,CAAWtB,IAAIK,IAAJ,CAASkB,UAAT,GAAsBV,MAAjC,CAAhB;AACAtB,uBAAW;AACPiC,2BAAW,aADJ;AAEPC,4BAAYzB,IAAIK,IAAJ,CAASkB,UAAT,GAAsBV,MAAtB,IAAgC,CAAhC,GACNO,SADM,GAENA,YAAY,CAJX;AAKPM,8BAAc,sBAASC,MAAT,EAAiB;AAC3BjB,oCAAgBC,WAAhB,EAA6BgB,SAAS,CAAtC,EAAyCd,MAAzC,EAAiD,IAAjD;AACH;AAPM,aAAX;AASH,SAhCD;AAiCH;;AAED,aAASnB,UAAT,GAAsB;AAClB,YAAIkC,WAAW,IAAItC,MAAJ,CAAW,gBAAX,EAA6B;AACxCuC,sBAAU,IAD8B;AAExCC,kBAAM,IAFkC;AAGxC;AACAvC,wBAAY,oBAJ4B;;AAMxC;AACAwC,wBAAY,qBAP4B;AAQxCC,wBAAY,qBAR4B;AASxCC,iCAAqB,IATmB;AAUxC;AACA;AACAC,0CAA+B;AAZS,SAA7B,CAAf;AAcH;;AAED,aAASvC,WAAT,GAAuB;AACnB,YAAIwC,cAAcC,SAASC,IAAT,CAAcC,WAAhC;AACAzC,UAAEC,GAAF,CAAM,8BAAN,EAAsCC,IAAtC,CAA2C,UAASC,GAAT,EAAc;AACrD,gBAAG,CAACuC,EAAEC,QAAF,CAAWxC,GAAX,CAAJ,EAAqBA,MAAMyC,KAAKC,KAAL,CAAW1C,GAAX,CAAN;AACrB,gBAAGA,IAAIC,IAAJ,IAAY,CAAf,EAAkB;AAClB,gBAAI0C,eAAe,EAAnB;AACAnD,0BAAc+C,EAAEK,QAAF,CAAWpD,WAAX,CAAd;AACAC,yBAAa8C,EAAEK,QAAF,CAAWnD,UAAX,CAAb;AACAO,gBAAIK,IAAJ,CAASC,GAAT,CAAa,UAASuC,SAAT,EAAoB;AAC7B,oBAAIC,cAAc,EAAlB;AACAD,0BAAU1B,WAAV,CAAsBb,GAAtB,CAA0B,UAASyC,WAAT,EAAsB;AAC5CD,mCAAerD,WAAWsD,WAAX,CAAf;AACH,iBAFD;AAGAF,0BAAU1B,WAAV,GAAwB2B,WAAxB;AACAH,gCAAgBnD,YAAYqD,SAAZ,CAAhB;AACH,aAPD;AAQAhD,cAAE,oBAAF,EAAwBU,MAAxB,CAA+BoC,YAA/B;AACA,gBAAIK,YAAY,CAAhB;AACA,gBAAGb,cAAc,GAAjB,EAAqB;AAChBa,4BAAY,CAAZ;AACJ,aAFD,MAEO,IAAGb,cAAc,GAAjB,EAAsB;AACzBa,4BAAY,CAAZ;AACH,aAFM,MAEA;AACHA,4BAAY,CAAZ;AACH;AACD,gBAAIC,SAAS;AACTpB,0BAAU,KADD;AAETC,sBAAM,IAFG;AAGToB,+BAAeF,SAHN;AAITG,gCAAgB,CAJP,EAIU;AACnBpB,4BAAY,YALH;AAMTC,4BAAY;AANH,aAAb;AAQAhC,gBAAIK,IAAJ,CAASC,GAAT,CAAa,UAASE,IAAT,EAAe;AACxB,oBAAIlB,MAAJ,CAAW,qBAAqBkB,KAAK4C,OAArC,EAA8CH,MAA9C;AACH,aAFD;AAGH,SAlCD;AAmCH;AACJ,CAxHD","file":"index.js","sourceRoot":"/Users/creator/workspace/furuida","sourcesContent":["define([\n    'module/navigation', 'swiper', 'module/pagination', 'tpl/tpl-classify-list', 'tpl/tpl-product-list', 'bootstrap'\n], function(initNav, Swiper, pagination, classifyTpl, productTpl) {\n    (function(){\n        initNav();\n        initBanner();\n        initProduct();\n    })();\n\n    function initClassNav() {\n        $.get(\"/api/product/getClassifyList\").done(function(res) {\n            if (res.code != 0)\n                return;\n            var tpl = function(id = \"\", name = \"\") {\n                return `<li class=\"list-group-item classify-item\">\n                    <a data-id=\"${id}\" href=\"javascript:;\">\n                        <span>${name}</span>\n                    </a>\n                </li>`\n            }\n            res.data.map(item => {\n                $('.classify-group').append(tpl(item._id, item.name))\n            });\n            initProductList(res.data[0].id);\n        });\n    }\n\n    function initProductList(productType, num, length, isNotPage) {\n        num = num || 0;\n        length = length || 9;\n        $.get('/api/product/getProductListByType', {\n            type: productType,\n            startPos: num * length,\n            length: length\n        }).done(function(res) {\n            if (res.code != 0)\n                return;\n            var tpl = function(path = \"\", name = \"\") {\n                return `<li class=\"col-lg-4 product-item\">\n                                <div class=\"product-img\">\n                                    <img src=\"${path}\" alt=\"${name}\">\n                                </div>\n                                <a class=\"product-link\" href=\"javascript:;\">${name}</a>\n                            </li>`;\n            }\n            $(\".product-group\").empty();\n            res.data.productList.map(item => {\n                $(\".product-group\").append(tpl(item.path, item.name));\n            })\n\n            if (isNotPage)\n                return;\n            var totalPage = Math.floor(res.data.totalCount / length);\n            pagination({\n                container: '#pagination',\n                totalPages: res.data.totalCount % length == 0\n                    ? totalPage\n                    : totalPage + 1,\n                onPageChange: function(number) {\n                    initProductList(productType, number - 1, length, true);\n                }\n            })\n        })\n    }\n\n    function initBanner() {\n        var mySwiper = new Swiper('#swiper-banner', {\n            autoplay: 3000,\n            loop: true,\n            // 如果需要分页器\n            pagination: '.swiper-pagination',\n\n            // 如果需要前进后退按钮\n            nextButton: '.swiper-button-next',\n            prevButton: '.swiper-button-prev',\n            paginationClickable: true,\n            // 如果需要滚动条\n            // scrollbar: '.swiper-scrollbar',\n            autoplayDisableOnInteraction : false,\n        });\n    }\n\n    function initProduct() {\n        var swiperWidth = document.body.clientWidth;\n        $.get(\"/api/product/getIndexProduct\").done(function(res) {\n            if(!_.isObject(res)) res = JSON.parse(res);\n            if(res.code != 0) return ;\n            var classifyHtml = \"\";\n            classifyTpl = _.template(classifyTpl);\n            productTpl = _.template(productTpl);\n            res.data.map(function(classItem) {\n                var productHtml = \"\";\n                classItem.productList.map(function(productItem) {\n                    productHtml += productTpl(productItem);\n                });\n                classItem.productList = productHtml;\n                classifyHtml += classifyTpl(classItem);\n            });\n            $(\".product-container\").append(classifyHtml);\n            var showCount = 3;\n            if(swiperWidth > 960){\n                 showCount = 3;\n            } else if(swiperWidth > 768) {\n                showCount = 2;\n            } else {\n                showCount = 1;\n            }\n            var option = {\n                autoplay: false,\n                loop: true,\n                slidesPerView: showCount,\n                slidesPerGroup: 1, //showCount,\n                nextButton: \"nextButton\",\n                prevButton: \"prevButton\"\n            }\n            res.data.map(function(item) {\n                new Swiper(\"#product-swiper_\" + item.classId, option);\n            })\n        })\n    }\n})\n"]}