{"version":3,"sources":["node_modules/dom-align/lib/index.js"],"names":["Object","defineProperty","exports","value","_utils","require","_utils2","_interopRequireDefault","_getOffsetParent","_getOffsetParent2","_getVisibleRectForElement","_getVisibleRectForElement2","_adjustForViewport","_adjustForViewport2","_getRegion","_getRegion2","_getElFuturePos","_getElFuturePos2","obj","__esModule","isFailX","elFuturePos","elRegion","visibleRect","left","width","right","isFailY","top","height","bottom","isCompleteFailX","isCompleteFailY","flip","points","reg","map","ret","each","p","push","replace","m","flipOffset","offset","index","convertOffset","str","offsetLen","n","test","parseInt","substring","length","normalizeOffset","el","domAlign","refNode","align","targetOffset","overflow","target","source","concat","newOverflowCfg","fail","refNodeRegion","newElRegion","merge","adjustX","adjustY","newPoints","l","r","newOffset","newTargetOffset","newElFuturePos","_newPoints","t","b","_newOffset","_newTargetOffset","_newElFuturePos","mix","css","useCssRight","useCssBottom","useCssTransform","__getOffsetParent","__getVisibleRectForElement","module"],"mappings":"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","file":"index.js","sourceRoot":"/Users/creator/workspace/furuida","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _getOffsetParent = require('./getOffsetParent');\n\nvar _getOffsetParent2 = _interopRequireDefault(_getOffsetParent);\n\nvar _getVisibleRectForElement = require('./getVisibleRectForElement');\n\nvar _getVisibleRectForElement2 = _interopRequireDefault(_getVisibleRectForElement);\n\nvar _adjustForViewport = require('./adjustForViewport');\n\nvar _adjustForViewport2 = _interopRequireDefault(_adjustForViewport);\n\nvar _getRegion = require('./getRegion');\n\nvar _getRegion2 = _interopRequireDefault(_getRegion);\n\nvar _getElFuturePos = require('./getElFuturePos');\n\nvar _getElFuturePos2 = _interopRequireDefault(_getElFuturePos);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// http://yiminghe.iteye.com/blog/1124720\n\n/**\n * align dom node flexibly\n * @author yiminghe@gmail.com\n */\n\nfunction isFailX(elFuturePos, elRegion, visibleRect) {\n  return elFuturePos.left < visibleRect.left || elFuturePos.left + elRegion.width > visibleRect.right;\n}\n\nfunction isFailY(elFuturePos, elRegion, visibleRect) {\n  return elFuturePos.top < visibleRect.top || elFuturePos.top + elRegion.height > visibleRect.bottom;\n}\n\nfunction isCompleteFailX(elFuturePos, elRegion, visibleRect) {\n  return elFuturePos.left > visibleRect.right || elFuturePos.left + elRegion.width < visibleRect.left;\n}\n\nfunction isCompleteFailY(elFuturePos, elRegion, visibleRect) {\n  return elFuturePos.top > visibleRect.bottom || elFuturePos.top + elRegion.height < visibleRect.top;\n}\n\nfunction flip(points, reg, map) {\n  var ret = [];\n  _utils2[\"default\"].each(points, function (p) {\n    ret.push(p.replace(reg, function (m) {\n      return map[m];\n    }));\n  });\n  return ret;\n}\n\nfunction flipOffset(offset, index) {\n  offset[index] = -offset[index];\n  return offset;\n}\n\nfunction convertOffset(str, offsetLen) {\n  var n = void 0;\n  if (/%$/.test(str)) {\n    n = parseInt(str.substring(0, str.length - 1), 10) / 100 * offsetLen;\n  } else {\n    n = parseInt(str, 10);\n  }\n  return n || 0;\n}\n\nfunction normalizeOffset(offset, el) {\n  offset[0] = convertOffset(offset[0], el.width);\n  offset[1] = convertOffset(offset[1], el.height);\n}\n\nfunction domAlign(el, refNode, align) {\n  var points = align.points;\n  var offset = align.offset || [0, 0];\n  var targetOffset = align.targetOffset || [0, 0];\n  var overflow = align.overflow;\n  var target = align.target || refNode;\n  var source = align.source || el;\n  offset = [].concat(offset);\n  targetOffset = [].concat(targetOffset);\n  overflow = overflow || {};\n  var newOverflowCfg = {};\n\n  var fail = 0;\n  // 当前节点可以被放置的显示区域\n  var visibleRect = (0, _getVisibleRectForElement2[\"default\"])(source);\n  // 当前节点所占的区域, left/top/width/height\n  var elRegion = (0, _getRegion2[\"default\"])(source);\n  // 参照节点所占的区域, left/top/width/height\n  var refNodeRegion = (0, _getRegion2[\"default\"])(target);\n  // 将 offset 转换成数值，支持百分比\n  normalizeOffset(offset, elRegion);\n  normalizeOffset(targetOffset, refNodeRegion);\n  // 当前节点将要被放置的位置\n  var elFuturePos = (0, _getElFuturePos2[\"default\"])(elRegion, refNodeRegion, points, offset, targetOffset);\n  // 当前节点将要所处的区域\n  var newElRegion = _utils2[\"default\"].merge(elRegion, elFuturePos);\n\n  // 如果可视区域不能完全放置当前节点时允许调整\n  if (visibleRect && (overflow.adjustX || overflow.adjustY)) {\n    if (overflow.adjustX) {\n      // 如果横向不能放下\n      if (isFailX(elFuturePos, elRegion, visibleRect)) {\n        // 对齐位置反下\n        var newPoints = flip(points, /[lr]/ig, {\n          l: 'r',\n          r: 'l'\n        });\n        // 偏移量也反下\n        var newOffset = flipOffset(offset, 0);\n        var newTargetOffset = flipOffset(targetOffset, 0);\n        var newElFuturePos = (0, _getElFuturePos2[\"default\"])(elRegion, refNodeRegion, newPoints, newOffset, newTargetOffset);\n        if (!isCompleteFailX(newElFuturePos, elRegion, visibleRect)) {\n          fail = 1;\n          points = newPoints;\n          offset = newOffset;\n          targetOffset = newTargetOffset;\n        }\n      }\n    }\n\n    if (overflow.adjustY) {\n      // 如果纵向不能放下\n      if (isFailY(elFuturePos, elRegion, visibleRect)) {\n        // 对齐位置反下\n        var _newPoints = flip(points, /[tb]/ig, {\n          t: 'b',\n          b: 't'\n        });\n        // 偏移量也反下\n        var _newOffset = flipOffset(offset, 1);\n        var _newTargetOffset = flipOffset(targetOffset, 1);\n        var _newElFuturePos = (0, _getElFuturePos2[\"default\"])(elRegion, refNodeRegion, _newPoints, _newOffset, _newTargetOffset);\n        if (!isCompleteFailY(_newElFuturePos, elRegion, visibleRect)) {\n          fail = 1;\n          points = _newPoints;\n          offset = _newOffset;\n          targetOffset = _newTargetOffset;\n        }\n      }\n    }\n\n    // 如果失败，重新计算当前节点将要被放置的位置\n    if (fail) {\n      elFuturePos = (0, _getElFuturePos2[\"default\"])(elRegion, refNodeRegion, points, offset, targetOffset);\n      _utils2[\"default\"].mix(newElRegion, elFuturePos);\n    }\n\n    // 检查反下后的位置是否可以放下了\n    // 如果仍然放不下只有指定了可以调整当前方向才调整\n    newOverflowCfg.adjustX = overflow.adjustX && isFailX(elFuturePos, elRegion, visibleRect);\n\n    newOverflowCfg.adjustY = overflow.adjustY && isFailY(elFuturePos, elRegion, visibleRect);\n\n    // 确实要调整，甚至可能会调整高度宽度\n    if (newOverflowCfg.adjustX || newOverflowCfg.adjustY) {\n      newElRegion = (0, _adjustForViewport2[\"default\"])(elFuturePos, elRegion, visibleRect, newOverflowCfg);\n    }\n  }\n\n  // need judge to in case set fixed with in css on height auto element\n  if (newElRegion.width !== elRegion.width) {\n    _utils2[\"default\"].css(source, 'width', _utils2[\"default\"].width(source) + newElRegion.width - elRegion.width);\n  }\n\n  if (newElRegion.height !== elRegion.height) {\n    _utils2[\"default\"].css(source, 'height', _utils2[\"default\"].height(source) + newElRegion.height - elRegion.height);\n  }\n\n  // https://github.com/kissyteam/kissy/issues/190\n  // 相对于屏幕位置没变，而 left/top 变了\n  // 例如 <div 'relative'><el absolute></div>\n  _utils2[\"default\"].offset(source, {\n    left: newElRegion.left,\n    top: newElRegion.top\n  }, {\n    useCssRight: align.useCssRight,\n    useCssBottom: align.useCssBottom,\n    useCssTransform: align.useCssTransform\n  });\n\n  return {\n    points: points,\n    offset: offset,\n    targetOffset: targetOffset,\n    overflow: newOverflowCfg\n  };\n}\n\ndomAlign.__getOffsetParent = _getOffsetParent2[\"default\"];\n\ndomAlign.__getVisibleRectForElement = _getVisibleRectForElement2[\"default\"];\n\nexports[\"default\"] = domAlign;\n/**\n *  2012-04-26 yiminghe@gmail.com\n *   - 优化智能对齐算法\n *   - 慎用 resizeXX\n *\n *  2011-07-13 yiminghe@gmail.com note:\n *   - 增加智能对齐，以及大小调整选项\n **/\n\nmodule.exports = exports['default'];"]}