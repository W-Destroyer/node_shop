{"version":3,"sources":["public/src/js/product/product.js"],"names":["define","initNav","pagination","common","tplProductList","hashObj","getHashParam","productType","type","initProductList","startPos","$","children","addClass","window","addEventListener","removeClass","num","length","isNotPage","get","undefined","then","res","JOSN","parse","code","productList","_","template","empty","data","map","append","productId","item","_id","productPath","mainImg","productName","totalPages","Math","ceil","totalCount","currentPage","container","onPageChange","number","location","hash","buildParam","catch","err","console","error"],"mappings":";;;;AAAAA,OAAO,CACH,mBADG,EAEH,mBAFG,EAGH,eAHG,EAIH,uBAJG,CAAP,EAKG,UAASC,OAAT,EAAkBC,UAAlB,EAA8BC,MAA9B,EAAsCC,cAAtC,EAAsD;AACrD,KAAC,YAAW;AACRH;AACA,YAAII,UAAUF,OAAOG,YAAP,EAAd;AACA,YAAIC,cAAcF,QAAQG,IAA1B;AACAC,wBAAgBJ,QAAQG,IAAxB,EAA8BH,QAAQK,QAAtC;AACAC,UAAE,gBAAgBJ,eAAe,KAA/B,CAAF,EAAyCK,QAAzC,CAAkD,GAAlD,EAAuDC,QAAvD,CAAgE,QAAhE;AACAC,eAAOC,gBAAP,CAAwB,YAAxB,EAAsC,YAAW;AAC7C,gBAAIV,UAAUF,OAAOG,YAAP,EAAd;AACA,gBAAGD,QAAQG,IAAR,IAAgBD,WAAnB,EAAgC;AAChCA,0BAAcF,QAAQG,IAAtB;AACAC,4BAAgBJ,QAAQG,IAAxB,EAA8BH,QAAQK,QAAtC;AACAC,cAAE,gCAAF,EAAoCK,WAApC,CAAgD,QAAhD;AACAL,cAAE,gBAAgBJ,eAAe,KAA/B,CAAF,EAAyCK,QAAzC,CAAkD,GAAlD,EAAuDC,QAAvD,CAAgE,QAAhE;AACH,SAPD;AAQH,KAdD;;AAgBA,aAASJ,eAAT,CAAyBF,WAAzB,EAAsCU,GAAtC,EAA2CC,MAA3C,EAAmDC,SAAnD,EAA8D;AAC1DF,cAAMA,OAAO,CAAb;AACAC,iBAASA,UAAU,CAAnB;AACAP,UAAES,GAAF,CAAM,mCAAN,EAA2C;AACvCZ,kBAAMD,eAAec,SAAf,IAA4Bd,eAAe,KAA3C,GAAmD,EAAnD,GAAwDA,WADvB;AAEvCG,sBAAUO,MAAMC,MAFuB;AAGvCA,oBAAQA;AAH+B,SAA3C,EAIGI,IAJH,CAIQ,UAASC,GAAT,EAAc;AAClB,gBAAG,QAAOA,GAAP,yCAAOA,GAAP,MAAc,QAAjB,EAA2BA,MAAMC,KAAKC,KAAL,CAAWF,GAAX,CAAN;AAC3B,gBAAIA,IAAIG,IAAJ,IAAY,CAAhB,EAAmB;AACnBC,0BAAcC,EAAEC,QAAF,CAAWzB,cAAX,CAAd;AACAO,cAAE,gBAAF,EAAoBmB,KAApB;AACAP,gBAAIQ,IAAJ,CAASJ,WAAT,CAAqBK,GAArB,CAAyB,gBAAQ;AAC7BrB,kBAAE,gBAAF,EAAoBsB,MAApB,CAA2BN,YAAY;AACnCO,+BAAWC,KAAKC,GADmB;AAEnCC,iCAAaF,KAAKG,OAFiB;AAGnCC,iCAAaJ,KAAKI;AAHiB,iBAAZ,CAA3B;AAKH,aAND;AAOA,gBAAIpB,SAAJ,EAAe;AACf,gBAAIqB,aAAaC,KAAKC,IAAL,CAAUnB,IAAIQ,IAAJ,CAASY,UAAT,GAAsBzB,MAAhC,CAAjB;AACA,gBAAI0B,cAAc,CAAE3B,GAAF,GAAQ,CAA1B;AACAf,uBAAW;AACP2C,2BAAW,aADJ;AAEPD,6BAAaA,cAAcJ,UAAd,GAA2B,CAA3B,GAA+BI,WAFrC;AAGPJ,4BAAYA,UAHL;AAIPM,8BAAc,sBAASC,MAAT,EAAiB;AAC3BjC,2BAAOkC,QAAP,CAAgBC,IAAhB,GAAuB9C,OAAO+C,UAAP,CAAkB,EAAC1C,MAAMD,WAAP,EAAoBG,UAAUqC,SAAS,CAAvC,EAAlB,CAAvB;AACAtC,oCAAgBF,WAAhB,EAA6BwC,SAAS,CAAtC,EAAyC7B,MAAzC,EAAiD,IAAjD;AACH;AAPM,aAAX;AASH,SA5BD,EA4BGiC,KA5BH,CA4BS,UAASC,GAAT,EAAc;AACnBC,oBAAQC,KAAR,CAAcF,GAAd;AACH,SA9BD;AA+BH;AACJ,CAzDD","file":"product.js","sourceRoot":"/Users/creator/workspace/furuida","sourcesContent":["define([\n    'module/navigation',\n    'module/pagination',\n    'module/common',\n    'tpl/tpl-product-list2'\n], function(initNav, pagination, common, tplProductList) {\n    (function() {\n        initNav();\n        var hashObj = common.getHashParam();\n        var productType = hashObj.type;\n        initProductList(hashObj.type, hashObj.startPos);\n        $('#classify_' + (productType || 'all')).children('a').addClass('active');\n        window.addEventListener('hashchange', function() {\n            var hashObj = common.getHashParam();\n            if(hashObj.type == productType) return;\n            productType = hashObj.type;\n            initProductList(hashObj.type, hashObj.startPos)\n            $('.met-column-nav-ul .dropdown a').removeClass('active');\n            $('#classify_' + (productType || 'all')).children('a').addClass('active');\n        })\n    })();\n\n    function initProductList(productType, num, length, isNotPage) {\n        num = num || 0;\n        length = length || 8;\n        $.get('/api/product/getProductListByType', {\n            type: productType == undefined || productType == 'all' ? '' : productType,\n            startPos: num * length,\n            length: length\n        }).then(function(res) {\n            if(typeof res != \"object\") res = JOSN.parse(res);\n            if (res.code != 0) return;\n            productList = _.template(tplProductList);\n            $(\"#product-group\").empty();\n            res.data.productList.map(item => {\n                $(\"#product-group\").append(productList({\n                    productId: item._id,\n                    productPath: item.mainImg,\n                    productName: item.productName\n                }));\n            })\n            if (isNotPage) return;\n            var totalPages = Math.ceil(res.data.totalCount / length);\n            var currentPage = + num + 1;\n            pagination({\n                container: '#pagination',\n                currentPage: currentPage > totalPages ? 1 : currentPage,\n                totalPages: totalPages,\n                onPageChange: function(number) {\n                    window.location.hash = common.buildParam({type: productType, startPos: number - 1 })\n                    initProductList(productType, number - 1, length, true);\n                }\n            })\n        }).catch(function(err) {\n            console.error(err)\n        })\n    }\n})"]}